<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="ntpu.content">
<body>

<metal:main fill-slot="main">
  <metal:content-core define-macro="content-core">

<tal:isowner condition="context/@@is_owner">

    <h2 i18n:translate="">Personal informat</h2>
    <div>
<!--      <p><strong i18n:translate="">Name:</strong><span tal:replace="context/Title" /></p>
      <p><strong i18n:translate="">Email:</strong><span tal:replace="context/email" /></p>
-->
      <form tal:attributes="action string:${context/absolute_url}/@@edit">
          <input type="submit" value="Edit profile" i18n:attributes="value"/>
      </form>
    </div>
    <br/><hr/>

<!-- 管理員桌面 -->
<tal:admin define="roles context/@@get_roles"
             condition="python:'Site Administrator' in roles or 'Manager' in roles">

    <h2 i18n:translate="">New submitted article</h2>
    <div tal:define="catalog python:context.portal_catalog;
                     brain python:catalog({'Type':'Article',
                                           'review_state':['accepted', 'afterModifyAgree',
                                           'inReview', 'internalAssigned', 'modifyThenReview', 'rejected']})"
         tal:repeat="item brain">
        <p><strong i18n:translate="">Article title(Chinese):</strong>
           <span tal:replace="item/articleTitleC" />
        </p>
        <p tal:condition="item/articleTitleE"><strong i18n:translate="">Article title(English):</strong>
           <span tal:replace="item/articleTitleE" />
        </p>
      <form tal:attributes="action string:${item/getURL}">
          <input type="submit" value="Detail" i18n:attributes="value"/>
      </form>
      <br/>
    </div>
    <br/><hr/>
</tal:admin>

<!-- 主編桌面 -->
<tal:super_editor define="roles context/@@get_roles"
             condition="python:'Super Editor' in roles">

    <h2 i18n:translate="">Review Article</h2>
    <div tal:define="catalog python:context.portal_catalog;
                     brain python:catalog({'Type':'Article',
                                           'review_state':['accepted', 'afterModifyAgree',
                                           'inReview', 'internalAssigned', 'modifyThenReview', 'rejected']})"
         tal:repeat="item brain">

        <p><strong i18n:translate="">Article title(Chinese):</strong>
           <span tal:replace="item/articleTitleC" />
        </p>
        <p tal:condition="item/articleTitleE"><strong i18n:translate="">Article title(English):</strong>
           <span tal:replace="item/articleTitleE" />
        </p>
        <p tal:condition="item/review_state"><strong i18n:translate="">Review state:</strong>
           <span tal:replace="item/review_state" />
        </p>
      <form tal:attributes="action string:${item/getURL}">
          <input type="submit" value="Detail" i18n:attributes="value"/>
      </form>
      <br/>
    </div>
    <br/><hr/>

</tal:super_editor>

<!-- 責任編輯桌面 -->
<tal:internalReview define="roles context/@@get_roles"
             condition="python:'Internal Reviewer' in roles or 'Manager' in roles">

    <h2 i18n:translate="">Waitting for Review Article</h2>
    <div tal:define="catalog python:context.portal_catalog;
                     items view/internalReviewerBackRef"
         tal:repeat="item items">

        <p><strong i18n:translate="">Article title(Chinese):</strong>
           <span tal:replace="item/articleTitle" />
        </p>
        <p tal:condition="item/engTitle"><strong i18n:translate="">Article title(English):</strong>
           <span tal:replace="item/engTitle" />
        </p>
      <form tal:attributes="action string:${item/absolute_url}">
          <input type="submit" value="Detail" i18n:attributes="value"/>
      </form>
      <br/>
    </div>
    <br/><hr/>
</tal:internalReview>


<!-- 審查委員桌面 -->
<tal:ExternalReview define="roles context/@@get_roles"
                    condition="python:'External Reviewer' in roles or 'Manager' in roles">
<tal:test define="backref view/externalReviewerBackRef" />

    <h2 i18n:translate="">External Reviewer Region</h2>
    <div tal:define="brain view/internalAssigned;
                     currentUserId context/@@getCurrentUserId"
         tal:repeat="item brain">
      <tal:check condition="python:item.assignInternalReviewer == currentUserId">
        <p><strong i18n:translate="">Article title(Chinese):</strong>
           <span tal:replace="item/articleTitleC" />
        </p>
        <p tal:condition="item/articleTitleE"><strong i18n:translate="">Article title(English):</strong>
           <span tal:replace="item/articleTitleE" />
        </p>
        <p tal:condition="item/abstract"><strong i18n:translate="">Abstract(Chinese):</strong>
           <span tal:replace="item/abstract" />
        </p>
        <p tal:condition="item/engAbstract"><strong i18n:translate="">Abstract(English):</strong>
           <span tal:replace="item/engAbstract" />
        </p>

      <form tal:attributes="action string:${item/getURL}">
          <input type="submit" value="Detail" i18n:attributes="value"/>
      </form>
      <br/>
      </tal:check>
    </div>
    <br/><hr/>
</tal:ExternalReview>

</tal:isowner>
  </metal:content-core>
</metal:main>

</body>
</html>

